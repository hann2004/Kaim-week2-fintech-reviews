name: Python Tests

on:
  push:
    branches: [main, task-1]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.9]

    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python-version }}
        
    - name: Install core dependencies only
      run: |
        python -m pip install --upgrade pip
        pip install google-play-scraper pandas numpy tqdm
        
    - name: Verify basic imports
      run: |
        python -c "import pandas; print('✓ pandas imported')"
        python -c "from google_play_scraper import app; print('✓ google-play-scraper imported')"
        python -c "import numpy; print('✓ numpy imported')"
        echo "✓ All core imports successful"
        
    - name: Verify project structure
      run: |
        echo "Verifying project structure..."
        [ -f "requirements.txt" ] && echo "✓ requirements.txt exists" || exit 1
        [ -f "README.md" ] && echo "✓ README.md exists" || exit 1
        [ -f "src/data_collection/scraper.py" ] && echo "✓ scraper.py exists" || exit 1
        echo "✓ Project structure verified"
    - name: Test database imports
      run: |
        python -c "import psycopg2; import sqlalchemy; from dotenv import load_dotenv; print('Database imports successful')"